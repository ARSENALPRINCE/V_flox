<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{ course.title }} - Course Details</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { font-family: Arial, sans-serif; background: #f5f6fa; margin: 0; padding: 0; }
        .container { max-width: 900px; margin: 40px auto; background: #fff; border-radius: 10px; box-shadow: 0 2px 12px rgba(0,0,0,0.07); padding: 32px; }
        .course-header { display: flex; gap: 32px; align-items: flex-start; }
        .course-thumb { width: 320px; height: 180px; object-fit: cover; border-radius: 8px; }
        .course-info { flex: 1; }
        .course-title { font-size: 2rem; color: #0984e3; margin-bottom: 8px; }
        .course-instructor { color: #636e72; margin-bottom: 8px; }
        .course-rating { color: #fdcb6e; font-size: 1.1rem; margin-bottom: 8px; }
        .course-price { font-weight: bold; color: #00b894; font-size: 1.2rem; margin-bottom: 8px; }
        .free-tag { background: #00b894; color: #fff; padding: 2px 8px; border-radius: 4px; font-size: 1rem; }
        .enroll-btn { background: #0984e3; color: #fff; padding: 10px 28px; border: none; border-radius: 5px; font-size: 1.1rem; cursor: pointer; margin-top: 12px; }
        .enroll-btn:hover { background: #0652dd; }
        .section { margin-top: 36px; }
        .section-title { font-size: 1.3rem; color: #2d3436; margin-bottom: 12px; }
        .lesson-list { list-style: none; padding: 0; }
        .lesson-item { padding: 10px 0; border-bottom: 1px solid #f1f2f6; display: flex; align-items: center; }
        .preview-badge { background: #fdcb6e; color: #fff; font-size: 0.9rem; padding: 2px 8px; border-radius: 4px; margin-left: 10px; }
        .instructor-profile { display: flex; align-items: center; gap: 16px; }
        .instructor-avatar { width: 60px; height: 60px; border-radius: 50%; object-fit: cover; }
        .review-list { list-style: none; padding: 0; }
        .review-item { border-bottom: 1px solid #f1f2f6; padding: 12px 0; }
        .review-author { font-weight: bold; color: #636e72; }
        .review-rating { color: #fdcb6e; }
    </style>
</head>
<body>
    <div class="container">
        <div class="course-header">
            <img src="{{ course.thumbnail.url }}" alt="Course Thumbnail" class="course-thumb">
            <div class="course-info">
                <div class="course-title">{{ course.title }}</div>
                <div class="course-instructor">Instructor: {{ instructor.get_full_name|default:instructor.username }}</div>
                <div class="course-rating">&#9733; {{ course.rating|default:"4.8" }} ({{ course.enrollments.count }} students)</div>
                {% if course.is_free %}
                    <span class="free-tag">Free</span>
                {% else %}
                    <span class="course-price">${{ course.price }}</span>
                {% endif %}
                <form method="post" action="{% url 'enroll_course' course.id %}">
                    {% csrf_token %}
                    <button type="submit" class="enroll-btn">Enroll Now</button>
                </form>
            </div>
        </div>

        <div class="section">
            <div class="section-title">Course Description</div>
            <div>{{ course.description|linebreaks }}</div>
        </div>

        <div class="section">
            <div class="section-title">Curriculum Overview</div>
            <ul class="lesson-list">
                {% for lesson in lessons %}
                <li class="lesson-item">
                    {{ lesson.title }}
                    {% if lesson.is_preview %}
                        <span class="preview-badge">Preview</span>
                    {% endif %}
                </li>
                {% empty %}
                <li>No lessons yet.</li>
                {% endfor %}
            </ul>
        </div>

        <div class="section">
            <div class="section-title">Instructor Profile</div>
            <div class="instructor-profile">
                <img src="https://ui-avatars.com/api/?name={{ instructor.get_full_name|default:instructor.username }}" alt="Instructor" class="instructor-avatar">
                <div>
                    <div><strong>{{ instructor.get_full_name|default:instructor.username }}</strong></div>
                    <div>Email: {{ instructor.email }}</div>
                    <!-- Add more instructor info if available -->
                </div>
            </div>
        </div>

        <div class="section">
            <div class="section-title">Student Reviews</div>
            <ul class="review-list">
                {% for review in reviews %}
                <li class="review-item">
                    <div class="review-author">{{ review.user.username }}</div>
                    <div class="review-rating">&#9733; {{ review.rating }}</div>
                    <div>{{ review.comment }}</div>
                </li>
                {% empty %}
                <li>No reviews yet.</li>
                {% endfor %}
            </ul>
        </div>
    </div>
</body>
</html>